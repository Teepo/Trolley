<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Trolley Problem Inc. — Archive Premium</title>

<style>
:root {
    --bg: #0e0e10;
    --panel: #18181c;
    --accent: #c0392b;
    --accent-soft: #8e2b20;
    --text: #f1f1f1;
    --muted: #aaa;
}

body {
    margin: 0;
    background: var(--bg);
    font-family: 'Georgia', serif;
    color: var(--text);
}

header {
    text-align: center;
    padding: 40px 20px;
    background: linear-gradient(180deg, #111, #000);
    border-bottom: 1px solid #222;
}

h1 {
    margin: 0;
    letter-spacing: 2px;
    font-size: 32px;
}

.search-bar {
    margin-top: 20px;
}

input {
    padding: 10px;
    width: 280px;
    background: #111;
    border: 1px solid #333;
    color: white;
    border-radius: 4px;
}

.container {
    max-width: 1000px;
    margin: auto;
    padding: 30px 20px;
}

.chapter-title {
    margin-top: 50px;
    font-size: 22px;
    color: var(--muted);
    border-left: 4px solid var(--accent);
    padding-left: 10px;
}

.dilemma {
    background: var(--panel);
    padding: 25px;
    margin: 20px 0;
    border-radius: 8px;
    border: 1px solid #222;
    transition: 0.3s;
}

.dilemma:hover {
    border-color: var(--accent-soft);
}

.dilemma h2 {
    margin-top: 0;
}

.quote {
    font-style: italic;
    color: var(--muted);
    margin-bottom: 15px;
}

.intro, .leave {
    margin: 15px 0;
    line-height: 1.6;
}

.choices {
    display: flex;
    gap: 20px;
    margin-top: 20px;
}

.choice {
    flex: 1;
    padding: 15px;
    background: #111;
    border: 1px solid #333;
    border-radius: 6px;
    cursor: pointer;
    transition: 0.3s;
}

.choice:hover {
    border-color: var(--accent);
}

.choice h3 {
    margin-top: 0;
}

.final {
    margin-top: 15px;
    font-style: italic;
    color: #bbb;
    display: none;
    border-top: 1px solid #333;
    padding-top: 10px;
}

footer {
    text-align: center;
    padding: 40px;
    color: #666;
    font-size: 14px;
}
</style>
</head>

<body>

<header>
    <h1>Trolley Problem Inc.</h1>
    <div class="search-bar">
        <input type="text" id="search" placeholder="Rechercher un dilemme...">
    </div>
</header>

<div class="container" id="app"></div>

<footer>
Archive narrative interactive — Version Premium
</footer>

<script>
fetch("data.json")
.then(res => res.json())
.then(data => {

    const rows = data.Rows;
    const keys = Object.keys(rows).sort((a,b) =>
        a.localeCompare(b, undefined, { numeric: true })
    );

    const container = document.getElementById("app");
    let currentChapter = "";

    keys.forEach(key => {

        const parts = key.split(".");
        const chapter = parts[0];

        if (chapter !== currentChapter) {
            currentChapter = chapter;
            const chap = document.createElement("div");
            chap.className = "chapter-title";
            chap.textContent = "Chapitre " + chapter;
            container.appendChild(chap);
        }

        const d = rows[key];

        const div = document.createElement("div");
        div.className = "dilemma";
        div.dataset.search = (d.Title + d.Text_Intro).toLowerCase();

        div.innerHTML = `
            <h2>${key} — ${d.Title || ""}</h2>
            <div class="quote">${d.Intro_Quote || ""}</div>
            <div class="intro">${d.Text_Intro || ""}</div>
            <div class="leave">${d.Text_Leave || ""}</div>

            <div class="choices">
                <div class="choice" data-final="a">
                    <h3>${d.Text_Leave || ""}</h3>
                    <p>${d.Text_01_A || ""}</p>
                    <p>${d.Text_02_A || ""}</p>
                    <div class="final">${d.FinalText_A || ""}</div>
                </div>

                <div class="choice" data-final="b">
                    <h3>${d.Text_Action || ""}</h3>
                    <p>${d.Text_01_B || ""}</p>
                    <p>${d.Text_02_B || ""}</p>
                    <div class="final">${d.FinalText_B || ""}</div>
                </div>
            </div>
        `;

        div.querySelectorAll(".choice").forEach(choice => {
            choice.addEventListener("click", () => {
                const final = choice.querySelector(".final");
                final.style.display = "block";
            });
        });

        container.appendChild(div);
    });

    // Recherche dynamique
    document.getElementById("search").addEventListener("input", e => {
        const term = e.target.value.toLowerCase();
        document.querySelectorAll(".dilemma").forEach(d => {
            d.style.display = d.dataset.search.includes(term) ? "block" : "none";
        });
    });

});
</script>

</body>
</html>
